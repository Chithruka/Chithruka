<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chithruka Streamer</title>
    
    <link href='https://chithruka.blogspot.com/favicon.ico' rel='shortcut icon' type='image/x-icon'/>
    <link rel="manifest" href="manifest.json">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://image.tmdb.org">
    
    <link href="https://fonts.googleapis.com/css2?family=Amatic+SC:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>

<div id="page-background"></div>

<div class="container mx-auto px-4">

    <nav class="navbar">
        <div class="logo-text text-4xl md:text-6xl" onclick="location.href='index.html';">Chithruka</div>

        <div class="flex items-center gap-4">
            <div class="search-group">
                <button onclick="openFilterModal()" class="filter-btn" title="Filter Content">
                    <i class="fas fa-sliders-h"></i>
                </button>
                <div class="relative w-full max-w-[300px] flex-grow">
                    <input type="text" id="search-input" class="glass-input" placeholder="Search...">
                    <i class="fas fa-search absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm pointer-events-none"></i>
                </div>
                <ul id="search-results" class="glass-panel"></ul>
            </div>

            <div id="user-section" class="relative">
                <button id="tmdb-login-btn" onclick="authenticateTMDB()" class="login-btn">
                    <i class="fas fa-user-circle mr-2"></i>Login
                </button>
                <img id="user-avatar" src="" class="user-avatar hidden" onclick="toggleUserMenu()">
                <div id="user-menu" class="user-menu">
                    <div class="user-menu-item" onclick="loadMyLibrary('favorite')"><i class="fas fa-heart text-red-500 mr-2"></i> Favorites</div>
                    <div class="user-menu-item" onclick="loadMyLibrary('watchlist')"><i class="fas fa-bookmark text-blue-500 mr-2"></i> Watchlist</div>
                    <div class="user-menu-item" onclick="logoutTMDB()"><i class="fas fa-sign-out-alt text-gray-400 mr-2"></i> Logout</div>
                </div>
            </div>
        </div>
    </nav>

    <div id="hero-section">
        <div id="hero-slides"></div>
        <div id="hero-indicators" class="hero-indicators"></div>
    </div>

    <div id="continue-watching-section" class="mb-12 relative hidden">
            <div class="flex justify-between items-center px-2 mb-4 md:mb-6">
                <h2 class="text-xl md:text-2xl font-bold text-white flex items-center">
                    <i class="fas fa-history text-red-500 mr-3"></i> Continue Watching
                </h2>
                <button onclick="clearHistory()" class="text-xs text-gray-400 hover:text-white border border-gray-600 hover:border-red-500 px-3 py-1 rounded-full transition-colors">
                    Clear All
                </button>
            </div>
        <div class="relative group px-2">
            <button class="scroll-btn left-0 -ml-4" onclick="scrollContainer('continue-watching-container', -300)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div id="continue-watching-container" class="flex flex-nowrap gap-4 md:gap-5 overflow-x-auto pb-8 scrollbar-hide scroll-smooth py-4"></div>
            <button class="scroll-btn right-0 -mr-4" onclick="scrollContainer('continue-watching-container', 300)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <div class="mb-12 relative" id="top10-section">
        <h2 class="text-xl md:text-2xl font-bold mb-6 text-white flex items-center px-2">
            <i class="fas fa-crown text-yellow-500 mr-3"></i> Top 10 Trending
        </h2>
        <div class="relative group px-2">
            <button class="scroll-btn left-0 -ml-4" onclick="scrollContainer('top10-container', -300)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div id="top10-container" class="flex flex-nowrap gap-6 pl-4 overflow-x-auto pb-8 scrollbar-hide scroll-smooth">
                </div>
            <button class="scroll-btn right-0 -mr-4" onclick="scrollContainer('top10-container', 300)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <div id="details-section" class="glass-panel p-6 md:p-8 rounded-2xl hidden mb-8">
        <div class="flex flex-col md:flex-row gap-8">
            <div class="flex-shrink-0 mx-auto md:mx-0 w-48 md:w-52">
                <img id="detail-poster" src="" alt="Poster" class="w-full rounded-xl shadow-2xl object-cover border border-gray-700" loading="lazy">
            </div>
            <div class="flex-grow min-w-0">
                <img id="detail-logo" src="" alt="Title Logo" class="title-logo" loading="lazy">
                <h2 id="detail-heading" class="text-3xl md:text-4xl font-bold mb-1 text-white"></h2>
    
                <p id="detail-tagline" class="text-gray-400 italic text-sm md:text-base mb-4"></p>
                
                <div class="flex flex-wrap items-center gap-4 md:gap-5 text-sm text-gray-300 mb-6">
                    <span id="detail-date" class="flex items-center cursor-pointer hover:text-accent transition" title="Filter by Year"><i class="far fa-calendar-alt mr-2 text-accent"></i> <span></span></span>
                    <span id="detail-rating" class="flex items-center cursor-pointer hover:text-yellow-400 transition" title="Filter by Rating"><i class="fas fa-star text-yellow-500 mr-2"></i> <span></span></span>
                    <span id="detail-runtime" class="flex items-center"><i class="far fa-clock mr-2"></i> <span></span></span>
                    <span id="detail-status" class="flex items-center text-green-400 font-semibold"><i class="fas fa-info-circle mr-2"></i><span></span></span>
                    
                    <span id="detail-country" class="flex items-center hidden cursor-pointer hover:text-blue-400 transition"><i class="fas fa-globe mr-2"></i> <span></span></span>
                    <span id="detail-age" class="flex items-center hidden px-2 py-0.5 border border-gray-500 rounded text-xs font-bold"><span></span></span>
                </div>

                <div id="interaction-bar" class="interaction-bar hidden">
                    <div id="btn-favorite" onclick="toggleFavorite()" class="interact-btn" title="Add to Favorites"><i class="fa-regular fa-heart"></i></div>
                    <div id="btn-watchlist" onclick="toggleWatchlist()" class="interact-btn" title="Add to Watchlist"><i class="fa-regular fa-bookmark"></i></div>
                    <div onclick="toggleRatingSlider()" class="interact-btn" title="Rate this"><i class="fas fa-star"></i></div>
                        <button class="interaction-btn" onclick="shareMovie()" aria-label="Share">
                            <i class="fa-solid fa-share-nodes"></i>
                            <span>Share</span>
                        </button>
                    
                    <div id="toast" class="toast">Link copied to clipboard!</div>
                    <div id="rating-slider" class="rating-slider-container">
                        <input type="range" min="1" max="10" step="0.5" id="rating-input" oninput="document.getElementById('rating-val').innerText = this.value">
                        <span id="rating-val" class="text-sm font-bold text-yellow-400 w-6">5</span>
                        <button onclick="submitRating()" class="text-xs bg-white/20 px-2 py-1 rounded hover:bg-white/40">OK</button>
                    </div>
                </div>
                
                <div id="detail-genres" class="flex flex-wrap gap-2 mb-6"></div>
                <p id="detail-overview" class="text-gray-300 leading-relaxed text-sm md:text-base mb-6"></p>

                <div id="cast-container" class="mt-4">
                    <h4 class="text-sm font-bold text-gray-400 mb-3 uppercase tracking-wide">Top Cast</h4>
                    <div class="relative group">
                        <button class="scroll-btn left-0 -ml-2" onclick="scrollContainer('cast-list', -200)"><i class="fas fa-chevron-left"></i></button>
                        <div id="cast-list" class="cast-scroll scrollbar-hide scroll-smooth"></div>
                        <button class="scroll-btn right-0 -mr-2" onclick="scrollContainer('cast-list', 200)"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>

                <div id="crew-container" class="mt-6 hidden">
                    <h4 class="text-sm font-bold text-gray-400 mb-3 uppercase tracking-wide">Behind the Scenes</h4>
                    <div class="relative group">
                        <button class="scroll-btn left-0 -ml-2" onclick="scrollContainer('crew-list', -200)"><i class="fas fa-chevron-left"></i></button>
                        <div id="crew-list" class="cast-scroll scrollbar-hide scroll-smooth"></div>
                        <button class="scroll-btn right-0 -mr-2" onclick="scrollContainer('crew-list', 200)"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>

                <div class="info-grid">
                    <div class="info-block">
                        <h5><i class="fas fa-building mr-2"></i> Production</h5>
                        <div id="production-list" class="info-list text-sm text-gray-300"></div>
                    </div>
                    <div class="info-block">
                        <h5><i class="fas fa-calendar-check mr-2"></i> Release Dates</h5>
                        <div id="release-dates-list" class="info-list"></div>
                    </div>
                    <div class="info-block">
                        <h5><i class="fas fa-language mr-2"></i> Alt. Titles</h5>
                        <div id="alt-titles-list" class="info-list text-sm text-gray-300"></div>
                    </div>
                    <div class="info-block">
                        <h5><i class="fas fa-cogs mr-2"></i> Tech Specs</h5>
                        <div id="tech-specs-list" class="info-list text-sm text-gray-300"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="player-interface" class="hidden fade-in">
        <div class="mb-6 rounded-xl overflow-hidden shadow-2xl relative bg-black border border-gray-800">
             <div id="server-loading-msg" class="hidden"></div>
             <iframe id="player-iframe" allowfullscreen onerror="handleServerError()"></iframe>
        </div>

        <div class="glass-panel p-4 rounded-xl mb-6 flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div id="server-buttons" class="flex flex-wrap gap-2"></div>
            <div class="flex flex-wrap gap-3 w-full md:w-auto">
                <button id="next-ep-btn" onclick="nextEpisode()" class="action-btn btn-next flex-grow md:flex-grow-0 hidden shadow-lg">
                    <i class="fas fa-step-forward mr-2"></i> Next
                </button>
                <button onclick="openTrailerModal()" class="action-btn btn-trailer flex-grow md:flex-grow-0 shadow-lg">
                    <i class="fab fa-youtube mr-2"></i> Trailer
                </button>
                <button onclick="openDownloadModal()" class="action-btn btn-download flex-grow md:flex-grow-0 shadow-lg">
                    <i class="fas fa-download mr-2"></i> Download
                </button>
            </div>
        </div>

        <div id="tv-controls" class="hidden mb-12">
            <div class="mb-4">
                <div class="flex justify-between items-center mb-2">
                    <label class="text-xs text-gray-400 ml-1">Select Season</label>
                    <div id="season-status-badge" class="text-xs font-bold px-2 py-1 rounded bg-white/10 hidden"></div>
                </div>
                <select id="season-select" class="glass-select w-full p-3 rounded-xl font-bold text-white cursor-pointer" onchange="changeSeason(this.value)">
                    </select>
            </div>

            <div class="accordion-header" onclick="toggleAccordion()">
                <span id="current-episode-info" class="font-semibold">Select an Episode</span>
                <i id="accordion-icon" class="fas fa-chevron-down text-gray-400"></i>
            </div>
            <div id="episode-accordion-content" class="accordion-content"></div>
        </div>
    </div>

    <div id="collection-section" class="mb-8 relative hidden">
        <h2 id="collection-header" class="text-xl md:text-2xl font-bold mb-4 md:mb-6 text-white flex items-center px-2">
            <i class="fas fa-layer-group text-purple-500 mr-3"></i> Collection
        </h2>
        <div class="relative group px-2">
            <button class="scroll-btn left-0 -ml-4" onclick="scrollContainer('collection-container', -300)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div id="collection-container" class="flex flex-nowrap gap-4 md:gap-5 overflow-x-auto pb-8 scrollbar-hide scroll-smooth py-4"></div>
            <button class="scroll-btn right-0 -mr-4" onclick="scrollContainer('collection-container', 300)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <div id="recommendations-section" class="mb-8 relative hidden">
        <h2 class="text-xl md:text-2xl font-bold mb-4 md:mb-6 text-white flex items-center px-2">
            <i class="fas fa-thumbs-up text-blue-500 mr-3"></i> You May Also Like
        </h2>
        <div class="relative group px-2">
            <button class="scroll-btn left-0 -ml-4" onclick="scrollContainer('recommendations-container', -300)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div id="recommendations-container" class="flex flex-nowrap gap-4 md:gap-5 overflow-x-auto pb-8 scrollbar-hide scroll-smooth py-4"></div>
            <button class="scroll-btn right-0 -mr-4" onclick="scrollContainer('recommendations-container', 300)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>

    <div class="mb-12 relative">
        <h2 id="trending-header" class="text-xl md:text-2xl font-bold mb-4 md:mb-6 text-white flex items-center px-2">
            <i class="fas fa-fire text-orange-500 mr-3"></i> Trending Now
        </h2>
        <div class="relative group px-2">
            <button id="scroll-left" class="scroll-btn left-0 -ml-4" onclick="scrollContainer('trending-container', -300)">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div id="trending-container" class="flex flex-nowrap gap-4 md:gap-5 overflow-x-auto pb-8 scrollbar-hide scroll-smooth py-4"></div>
            <button id="scroll-right" class="scroll-btn right-0 -mr-4" onclick="scrollContainer('trending-container', 300)">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        </div>
</div>

<footer class="relative bg-black/90 backdrop-blur-xl border-t border-white/5 mt-24 pt-16 pb-8 z-10">
    <div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-red-600/50 to-transparent"></div>

    <div class="container mx-auto px-6 max-w-7xl">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-12">
            
            <div class="flex flex-col items-center md:items-start text-center md:text-left">
                <p class="text-gray-400 text-sm mb-6 max-w-xs leading-relaxed">
                    Your ultimate destination for movies & TV. Streaming perfection, curated just for you.
                </p>
                
                <div id="user-country" class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/5 border border-white/10 text-xs font-semibold text-gray-300 hover:bg-white/10 transition-colors">
                    <i class="fas fa-globe text-blue-500 animate-pulse"></i> Locating...
                </div>
            </div>

            <div class="flex flex-col items-center md:items-start">
                <h3 class="text-white font-bold mb-6 tracking-widest uppercase text-xs border-b-2 border-red-600 pb-1">Discover</h3>
                <ul class="space-y-3 text-sm text-gray-400 w-full text-center md:text-left">
                    <li><a href="#" onclick="window.scrollTo({top:0, behavior:'smooth'})" class="hover:text-red-500 transition-colors flex items-center justify-center md:justify-start gap-2"><i class="fas fa-home text-xs opacity-50"></i> Home</a></li>
                    <li><a href="#" onclick="quickFilter('movie', '', 'Trending Movies')" class="hover:text-red-500 transition-colors flex items-center justify-center md:justify-start gap-2"><i class="fas fa-fire text-xs opacity-50"></i> Trending Movies</a></li>
                    <li><a href="#" onclick="quickFilter('tv', '', 'Trending TV')" class="hover:text-red-500 transition-colors flex items-center justify-center md:justify-start gap-2"><i class="fas fa-tv text-xs opacity-50"></i> TV Series</a></li>
                    <li><a href="#" onclick="openFilterModal()" class="hover:text-red-500 transition-colors flex items-center justify-center md:justify-start gap-2"><i class="fas fa-search text-xs opacity-50"></i> Advanced Search</a></li>
                </ul>
            </div>

            <div class="flex flex-col items-center md:items-start">
                 <h3 class="text-white font-bold mb-6 tracking-widest uppercase text-xs border-b-2 border-red-600 pb-1">App & Legal</h3>
                 
                 <button id="install-app-btn" onclick="installPWA()" class="hidden w-full md:w-auto flex items-center justify-center gap-4 bg-white/5 hover:bg-red-600 text-white px-5 py-3 rounded-xl transition-all duration-300 group mb-6 border border-white/10 hover:border-red-500 hover:shadow-lg hover:shadow-red-900/20">
                    <i class="fab fa-android text-2xl group-hover:scale-110 transition-transform"></i>
                    <div class="text-left">
                        <div class="text-[10px] uppercase opacity-60 font-bold leading-none mb-1">Download for</div>
                        <div class="font-bold text-sm leading-none">Android / PC</div>
                    </div>
                </button>

                <p class="text-xs text-gray-500 leading-relaxed text-center md:text-left max-w-xs">
                    This site does not store any files on its server. All contents are provided by non-affiliated third parties.
                </p>
            </div>
        </div>

        <div class="border-t border-white/10 pt-8 flex flex-col md:flex-row items-center justify-between gap-6">
            <p class="text-xs text-gray-500 font-medium">
                &copy; <span id="footer-year"></span> Chithruka. All Rights Reserved.
            </p>
            
            <div class="flex gap-4">
                <a href="#" class="w-9 h-9 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-gray-400 hover:bg-blue-500 hover:text-white hover:border-blue-500 transition-all duration-300"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="w-9 h-9 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-gray-400 hover:bg-sky-500 hover:text-white hover:border-sky-500 transition-all duration-300"><i class="fab fa-twitter"></i></a>
                <a href="#" class="w-9 h-9 rounded-full bg-white/5 border border-white/10 flex items-center justify-center text-gray-400 hover:bg-pink-600 hover:text-white hover:border-pink-600 transition-all duration-300"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </div>
</footer>

<div id="filter-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center hidden z-50 p-4">
    <div class="glass-panel p-6 rounded-2xl max-w-sm w-full relative shadow-2xl">
        <button onclick="closeFilterModal()" class="absolute top-3 right-4 text-gray-400 hover:text-white text-xl"><i class="fas fa-times"></i></button>
        <h3 class="text-xl font-bold mb-4 text-center text-white">Discover</h3>
        <div class="flex flex-col gap-4">
            <div>
                <label class="block text-xs text-gray-400 mb-1">Type</label>
                <select id="filter-type" class="glass-select w-full p-2 rounded-lg" onchange="loadGenres()">
                    <option value="movie">Movie</option>
                    <option value="tv">TV Show</option>
                </select>
            </div>
            <div>
                <label class="block text-xs text-gray-400 mb-1">Genre</label>
                <select id="filter-genre" class="glass-select w-full p-2 rounded-lg">
                    <option value="">Any Genre</option>
                </select>
            </div>
            <div>
                <label class="block text-xs text-gray-400 mb-1">Country</label>
                <select id="filter-country" class="glass-select w-full p-2 rounded-lg">
                    <option value="">Any Country</option>
                </select>
            </div>
            <div class="flex gap-4">
                <div class="flex-1">
                    <label class="block text-xs text-gray-400 mb-1">Year</label>
                    <input type="number" id="filter-year" class="glass-input w-full p-2 rounded-lg" placeholder="2023">
                </div>
                <div class="flex-1">
                    <label class="block text-xs text-gray-400 mb-1">Min Rating</label>
                    <input type="number" step="0.1" id="filter-rating" class="glass-input w-full p-2 rounded-lg" placeholder="8.0">
                </div>
            </div>
            <div class="flex gap-3 mt-2">
                <button onclick="clearFilters()" class="flex-1 p-3 bg-gray-700 hover:bg-gray-600 rounded-lg text-white font-bold transition">Reset</button>
                <button onclick="applyFilter()" class="flex-1 p-3 bg-red-600 hover:bg-red-700 rounded-lg text-white font-bold transition">Apply</button>
            </div>
        </div>
    </div>
</div>

<div id="trailer-modal" class="fixed inset-0 bg-black/90 backdrop-blur-md flex items-center justify-center hidden z-50 p-4">
    <div class="w-full max-w-4xl relative">
        <button onclick="closeTrailerModal()" class="absolute -top-10 right-0 text-white hover:text-red-500 text-2xl"><i class="fas fa-times"></i> Close</button>
        <div class="relative w-full aspect-video rounded-xl overflow-hidden shadow-2xl bg-black">
            <iframe id="trailer-iframe" class="w-full h-full" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
        </div>
    </div>
</div>

<div id="download-modal" class="fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center hidden z-50 p-4">
    <div class="glass-panel p-6 rounded-2xl max-w-sm w-full relative shadow-2xl">
        <button onclick="closeDownloadModal()" class="absolute top-3 right-4 text-gray-400 hover:text-white text-xl"><i class="fas fa-times"></i></button>
        <h3 class="text-xl font-bold mb-2 text-center text-white">Download</h3>
        <p class="text-gray-400 text-sm text-center mb-6" id="download-modal-subtitle">Select a source</p>
        <div class="flex flex-col gap-3">
            <a id="dl-link-1" href="#" target="_blank" class="block w-full p-4 bg-gray-800/50 hover:bg-green-600/20 border border-gray-600 hover:border-green-500 rounded-xl text-center transition-all group">
                <div class="font-bold text-white mb-1">Source 1 (VidSrc)</div>
                <div class="text-xs text-gray-400 group-hover:text-green-300">Standard Quality</div>
            </a>
            <a id="dl-link-2" href="#" target="_blank" class="block w-full p-4 bg-gray-800/50 hover:bg-blue-600/20 border border-gray-600 hover:border-blue-500 rounded-xl text-center transition-all group">
                <div class="font-bold text-white mb-1">Source 2 (GoDrive)</div>
                <div class="text-xs text-gray-400 group-hover:text-blue-300">Fast Server</div>
            </a>
        </div>
    </div>
</div>

<div id="message-box" class="fixed bottom-5 right-5 p-4 rounded-lg shadow-lg hidden z-50 text-white font-semibold max-w-sm text-center"></div>
<script src="script.js"></script>
</body>
</html>
